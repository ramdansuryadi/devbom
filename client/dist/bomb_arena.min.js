!function t(e,i,o){function a(n,r){if(!i[n]){if(!e[n]){var h="function"==typeof require&&require;if(!r&&h)return h(n,!0);if(s)return s(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[n]={exports:{}};e[n][0].call(u.exports,function(t){var i=e[n][1][t];return a(i?i:t)},u,u.exports,t,e,i,o)}return i[n].exports}for(var s="function"==typeof require&&require,n=0;n<o.length;n++)a(o[n]);return a}({1:[function(t,e,i){function o(){socket=io("https://powerful-chamber-6580.herokuapp.com:443"),t("./game/mods/phaser_enhancements"),game.state.add("Boot",t("./game/states/boot")),game.state.add("Preloader",t("./game/states/preloader")),game.state.add("TitleScreen",t("./game/states/title_screen")),game.state.add("Lobby",t("./game/states/lobby")),game.state.add("StageSelect",t("./game/states/stage_select")),game.state.add("PendingGame",t("./game/states/pending_game")),game.state.add("Level",t("./game/states/level")),game.state.add("GameOver",t("./game/states/game_over")),game.state.start("Boot")}window.game=new Phaser.Game(1080,600,Phaser.AUTO,""),window.player=null,window.socket=null,window.level=null,window.TEXTURES="bbo_textures",window.MAP_THUMBNAILS="map_thumbnails",window.OTX=240,o()},{"./game/mods/phaser_enhancements":6,"./game/states/boot":7,"./game/states/game_over":8,"./game/states/level":9,"./game/states/lobby":10,"./game/states/pending_game":11,"./game/states/preloader":12,"./game/states/stage_select":13,"./game/states/title_screen":14}],2:[function(t,e,i){function o(t,e){return"gamesprites/"+t+"/"+t+"_"+e+".png"}var a=t("../util/audio_player"),s=t("../util/texture_util"),n=function(t,e,i){Phaser.Sprite.call(this,game,t,e,TEXTURES,"gamesprites/bomb/bomb_01.png"),this.id=i,this.anchor.setTo(.5,.5),game.physics.enable(this,Phaser.Physics.ARCADE),this.body.immovable=!0,game.add.existing(this),this.sizeTween=game.add.tween(this.scale).to({x:1.2,y:1.2},500,Phaser.Easing.Default,!0,0,!0,!0)};n.prototype=Object.create(Phaser.Sprite.prototype),n.prototype.remove=function(){this.destroy(),this.sizeTween.stop()},n.renderExplosion=function(t){t.forEach(function(t){var e=new Phaser.Sprite(game,t.x,t.y,TEXTURES,o(t.key,"01"));e.anchor.setTo(.5,.5),e.animations.add("explode",s.getFrames(o,t.key,["02","03","04","05"])),e.animations.getAnimation("explode").onComplete.add(function(){level.deadGroup.push(this)},e),t.hide?game.world.addAt(e,1):game.world.add(e),e.play("explode",17,!1),a.playBombSound()})},e.exports=n},{"../util/audio_player":15,"../util/texture_util":20}],3:[function(t,e,i){function o(){}function a(){}function s(){}function n(){}function n(){}function r(t){t=0==t?!0:!1,buttonUp.visible=t,buttonDown.visible=t,buttonLeft.visible=t,buttonRight.visible=t}var h=(t("./bomb"),t("../util/texture_util")),l=180,u=60,m=function(t,e,i,o){this.firstFrame=this.getFrame(o,"01"),Phaser.Sprite.call(this,game,t,e,TEXTURES,this.firstFrame),this.spawnPoint={x:t,y:e},this.id=i,this.facing="down",this.anchor.setTo(.5,.5),this.bombButtonJustPressed=!1,this.speed=l,this.firstFrame=this.getFrame(o,"01"),game.physics.enable(this,Phaser.Physics.ARCADE),this.body.setSize(15,16,1,15),this.animations.add("down",h.getFrames(this.getFrame,o,["01","02","03","04","05"]),10,!0),this.animations.add("up",h.getFrames(this.getFrame,o,["06","07","08","09","10"]),10,!0),this.animations.add("right",h.getFrames(this.getFrame,o,["11","12","13"]),10,!0),this.animations.add("left",h.getFrames(this.getFrame,o,["14","15","16"]),10,!0),game.add.existing(this),this.createButtonAmigo()};m.prototype=Object.create(Phaser.Sprite.prototype),m.prototype.handleInput=function(){buttonUp.input.pointerDown()||buttonDown.input.pointerDown()||buttonLeft.input.pointerDown()||buttonRight.input.pointerDown()||buttonBomb.input.pointerDown()||(this.handleMotionInput(),this.handleBombInput()),buttonBomb.input.pointerDown()&&this.actionOnClickBombX(),(buttonUp.input.pointerDown()||buttonDown.input.pointerDown()||buttonLeft.input.pointerDown()||buttonRight.input.pointerDown())&&this.acionMoveX()},m.prototype.handleMotionInput=function(){var t=!0,e=touchControl.speed;game.physics.arcade.collide(this,level.blockLayer),game.physics.arcade.collide(this,level.bombs),game.input.keyboard.isDown(Phaser.Keyboard.LEFT)?(this.body.velocity.y=0,this.body.velocity.x=-this.speed,this.facing="left"):game.input.keyboard.isDown(Phaser.Keyboard.RIGHT)?(this.body.velocity.y=0,this.body.velocity.x=this.speed,this.facing="right"):game.input.keyboard.isDown(Phaser.Keyboard.UP)?(this.body.velocity.x=0,this.body.velocity.y=-this.speed,this.facing="up"):game.input.keyboard.isDown(Phaser.Keyboard.DOWN)?(this.body.velocity.x=0,this.body.velocity.y=this.speed,this.facing="down"):Math.abs(e.y)<Math.abs(e.x)?touchControl.cursors.left?(this.body.velocity.y=0,this.body.velocity.x=-this.speed,this.facing="left",r(1)):touchControl.cursors.right&&(this.body.velocity.y=0,this.body.velocity.x=this.speed,this.facing="right",r(1)):Math.abs(e.y)>Math.abs(e.x)?touchControl.cursors.up?(this.body.velocity.x=0,this.body.velocity.y=-this.speed,this.facing="up",r(1)):touchControl.cursors.down&&(this.body.velocity.x=0,this.body.velocity.y=this.speed,this.facing="down",r(1)):(t=!1,this.freeze(),r(1)),t&&(this.animations.play(this.facing),socket.emit("move player",{x:this.position.x,y:this.position.y,facing:this.facing}))},m.prototype.handleBombInput=function(){!game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)||game.physics.arcade.overlap(this,level.bombs)||this.bombButtonJustPressed?!game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)&&this.bombButtonJustPressed&&(this.bombButtonJustPressed=!1):(this.bombButtonJustPressed=!0,socket.emit("place bomb",{x:this.body.position.x,y:this.body.position.y,id:game.time.now}))},m.prototype.freeze=function(){this.body.velocity.x=0,this.body.velocity.y=0,this.animations.stop()},m.prototype.applySpeedPowerup=function(){this.speed+=u},m.prototype.getFrame=function(t,e){return"gamesprites/bomberman_"+t+"/bomberman_"+t+"_"+e+".png"},m.prototype.reset=function(){this.x=this.spawnPoint.x,this.y=this.spawnPoint.y,this.frame=this.firstFrame,this.facing="down",this.bombButtonJustPressed=!1,this.speed=l,this.alive||this.revive()},m.prototype.createButtonAmigo=function(){buttonBomb=game.add.button(game.world.width-160,472,TEXTURES,this.actionOnClickBomb,this,"gamesprites/bomb/button_bomb_hover.png","gamesprites/bomb/button_bomb.png"),buttonUp=game.add.button(54,450,TEXTURES,o,this,"gamesprites/bomb/button_up_hover.png","gamesprites/bomb/button_up.png"),buttonDown=game.add.button(54,542,TEXTURES,a,this,"gamesprites/bomb/button_down_hover.png","gamesprites/bomb/button_down.png"),buttonLeft=game.add.button(32,473,TEXTURES,n,this,"gamesprites/bomb/button_left_hover.png","gamesprites/bomb/button_left.png"),buttonRight=game.add.button(122,473,TEXTURES,s,this,"gamesprites/bomb/button_right_hover.png","gamesprites/bomb/button_right.png"),buttonBomb.input.useHandCursor=!0,buttonUp.input.useHandCursor=!0,buttonDown.input.useHandCursor=!0,buttonLeft.input.useHandCursor=!0,buttonRight.input.useHandCursor=!0,buttonBomb.inputEnabled=!0,buttonUp.inputEnabled=!0,buttonDown.inputEnabled=!0,buttonLeft.inputEnabled=!0,buttonRight.inputEnabled=!0,buttonUp.visible=!1,buttonDown.visible=!1,buttonLeft.visible=!1,buttonRight.visible=!1},m.prototype.actionOnClickBombX=function(){game.physics.arcade.overlap(this,level.bombs)||this.bombButtonJustPressed?!game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)&&this.bombButtonJustPressed&&(this.bombButtonJustPressed=!1):(this.bombButtonJustPressed=!0,socket.emit("place bomb",{x:this.body.position.x,y:this.body.position.y,id:game.time.now}))},m.prototype.acionMoveX=function(){var t=!0;game.physics.arcade.collide(this,level.blockLayer),game.physics.arcade.collide(this,level.bombs),buttonLeft.input.pointerDown()?(this.body.velocity.y=0,this.body.velocity.x=-this.speed,this.facing="left"):buttonRight.input.pointerDown()?(this.body.velocity.y=0,this.body.velocity.x=this.speed,this.facing="right"):buttonUp.input.pointerDown()?(this.body.velocity.x=0,this.body.velocity.y=-this.speed,this.facing="up"):buttonDown.input.pointerDown()?(this.body.velocity.x=0,this.body.velocity.y=this.speed,this.facing="down"):(t=!0,this.freeze()),t&&(this.animations.play(this.facing),socket.emit("move player",{x:this.position.x,y:this.position.y,facing:this.facing}))},e.exports=m,m.prototype.actionOnClickBomb=function(){game.physics.arcade.overlap(this,level.bombs)||this.bombButtonJustPressed?!game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)&&this.bombButtonJustPressed&&(this.bombButtonJustPressed=!1):(this.bombButtonJustPressed=!0,socket.emit("place bomb",{x:this.body.position.x,y:this.body.position.y,id:game.time.now}))}},{"../util/texture_util":20,"./bomb":2}],4:[function(t,e,i){var o=100,a=t("../util/texture_util"),s=function(t,e,i,o){this.id=i,this.previousPosition={x:t,y:e},this.lastMoveTime=0,this.targetPosition,this.spawnPoint={x:t,y:e},this.firstFrame=this.getFrame(o,"01"),Phaser.Sprite.call(this,game,t,e,TEXTURES,this.firstFrame),game.physics.enable(this,Phaser.Physics.ARCADE),this.anchor.setTo(.5,.5),this.animations.add("down",a.getFrames(this.getFrame,o,["01","02","03","04","05"]),10,!0),this.animations.add("up",a.getFrames(this.getFrame,o,["06","07","08","09","10"]),10,!0),this.animations.add("right",a.getFrames(this.getFrame,o,["11","12","13"]),10,!0),this.animations.add("left",a.getFrames(this.getFrame,o,["14","15","16"]),10,!0),game.add.existing(this)};s.prototype=Object.create(Phaser.Sprite.prototype),s.prototype.interpolate=function(t){if(this.distanceToCover&&t)if(this.distanceCovered.x<Math.abs(this.distanceToCover.x)||this.distanceCovered.y<Math.abs(this.distanceToCover.y)){var e=(game.time.now-t)/o,i=e*this.distanceToCover.x,a=e*this.distanceToCover.y;this.distanceCovered.x+=Math.abs(i),this.distanceCovered.y+=Math.abs(a),this.position.x+=i,this.position.y+=a}else this.position.x=this.targetPosition.x,this.position.y=this.targetPosition.y},s.prototype.getFrame=function(t,e){return"gamesprites/bomberman_"+t+"/bomberman_"+t+"_"+e+".png"},s.prototype.reset=function(){this.x=this.spawnPoint.x,this.y=this.spawnPoint.y,this.frame=this.firstFrame,this.previousPosition={x:this.x,y:this.y},this.distanceToCover=null,this.distanceCovered=null,this.targetPosition=null,this.lastMoveTime=null,this.alive||this.revive()},e.exports=s},{"../util/texture_util":20}],5:[function(t,e,i){function o(t,e,i){Phaser.Group.call(this,t);var o=t.add.image(n,r,TEXTURES,"lobby/end_of_round_window.png"),s=t.add.text(h,l,"Round "+e+" Complete!");a.configureText(s,"white",32);var u=i.length>1?d-55:d,m=i.length>1?g:p,b=t.add.text(u,c,m);a.configureText(b,"white",28),b.alpha=0,this.add(o),this.add(s),this.add(b),this.createAndAddWinnerImages(i)}var a=t("../util/text_configurer"),s=600,n=OTX+100-s,r=60,h=OTX+150-s,l=65,u=OTX+225-s,m=310,d=OTX+220-s,c=220,p="Winner is...",g="Draw! Winners are...";o.prototype=Object.create(Phaser.Group.prototype),o.prototype.createAndAddWinnerImages=function(t){this.winnerImageIndices=[];var e=3;t.forEach(function(t){var i=new Phaser.Image(game,u,m,TEXTURES,"lobby/bomberman_head/bomberman_head_"+t+".png");i.scale={x:1.75,y:1.75},i.alpha=0,game.add.existing(i),this.add(i),this.winnerImageIndices.push(e++)},this)},o.prototype.beginAnimation=function(t){var e=game.add.tween(this);e.to({x:s},300),e.onComplete.addOnce(function(){i.start()},this);var i=game.add.tween(this.children[2]);i.to({alpha:1},800),i.onComplete.addOnce(function(){a.start()},this);var o=game.add.tween(this);o.to({x:2*s},300,Phaser.Easing.Default,!1,200),o.onComplete.addOnce(function(){t(),this.destroy()},this);var a=this.generateWinnerImageTween(this.winnerImageIndices,o);e.start()},o.prototype.generateWinnerImageTween=function(t,e){for(var i=[],o=this,a=0;a<t.length;a++)!function(s){var n=game.add.tween(o.children[t[s]]);n.to({alpha:1},900),a<t.length-1?(n.to({alpha:0},900),n.onComplete.addOnce(function(){i[s+1].start()})):n.onComplete.addOnce(function(){e.start()},o),i.push(n)}(a);return i[0]},e.exports=o},{"../util/text_configurer":19}],6:[function(t,e,i){Phaser.Group.prototype.removeAll=function(t,e){if("undefined"==typeof t&&(t=!1),"undefined"==typeof e&&(e=!1),0!==this.children.length){var i=0;do{this.children[i].doNotDestroy&&i++,!e&&this.children[i].events&&this.children[i].events.onRemovedFromGroup.dispatch(this.children[i],this);var o=this.removeChild(this.children[i]);t&&o&&o.destroy(!0)}while(this.children.length>i);this.cursor=null}}},{}],7:[function(t,e,i){var o=t("../util/audio_player"),a=function(){};e.exports=a,a.prototype={preload:function(){},create:function(){game.disableVisibilityChange=!0,game.input.maxPointers=1,o.initialize(),game.device.desktop?game.scale.pageAlignHorizontally=!0:(game.scaleMode=Phaser.ScaleManager.SHOW_ALL,game.scale.isFullScreen=!0,game.scale.minWidth=screen.width,game.scale.minHeight=screen.height,game.scale.maxWidth=screen.width,game.scale.maxHeight=screen.height,game.scale.forceLandscape=!0,game.scale.pageAlignHorizontally=!0,game.scale.setScreenSize(!0)),game.state.start("Preloader")}}},{"../util/audio_player":15}],8:[function(t,e,i){function o(){}var a=t("../util/text_configurer");o.prototype={init:function(t,e){this.winnerColor=t,this.winByDefault=e},create:function(){var t=this.winByDefault?"NO OTHER PLAYERS REMAINING.\nYOU WIN BY DEFAULT.":"GAME OVER.\nWINNER: "+this.winnerColor;t+="\n\n";var e=game.add.text(game.world.centerX,game.world.centerY-50,t,{align:"center",autoUpperCase:!0});e.anchor.setTo(.5,.5),a.configureText(e,"white",28),buttonEnter=game.add.button(game.world.centerX-95,300,TEXTURES,this.actionOnClickOk,this,"lobby/buttons/game_over_ok_button_2.png","lobby/buttons/game_over_ok_button_1.png"),buttonEnter.input.useHandCursor=!0,buttonEnter.inputEnabled=!0},update:function(){game.input.keyboard.isDown(Phaser.Keyboard.ENTER)&&this.returnToLobby()},returnToLobby:function(){game.state.start("Lobby")},actionOnClickOk:function(){this.returnToLobby()}},e.exports=o},{"../util/text_configurer":19}],9:[function(t,e,i){var o="#000000",a=40,s=t("../../../../common/powerup_ids"),n=t("../../../../common/map_info"),r=t("../util/audio_player"),h=t("../entities/player"),l=t("../entities/remoteplayer"),u=t("../entities/bomb"),m=t("../entities/round_end_animation"),d=t("../util/powerup_image_keys"),c=t("../util/powerup_notification_player"),p=function(){};e.exports=p,p.prototype={remotePlayers:{},gameFrozen:!0,init:function(t,e,i){this.tilemapName=t,this.players=e,this.playerId=i},setEventHandlers:function(){socket.on("disconnect",this.onSocketDisconnect),socket.on("m",this.onMovePlayer.bind(this)),socket.on("remove player",this.onRemovePlayer.bind(this)),socket.on("kill player",this.onKillPlayer.bind(this)),socket.on("place bomb",this.onPlaceBomb.bind(this)),socket.on("detonate",this.onDetonate.bind(this)),socket.on("new round",this.onNewRound.bind(this)),socket.on("end game",this.onEndGame.bind(this)),socket.on("no opponents left",this.onNoOpponentsLeft.bind(this)),socket.on("powerup acquired",this.onPowerupAcquired.bind(this))},create:function(){touchControl=game.plugins.add(Phaser.Plugin.TouchControl),touchControl.inputEnable(),level=this,this.lastFrameTime,this.deadGroup=[],this.initializeMap(),this.bombs=game.add.group(),this.items={},game.physics.enable(this.bombs,Phaser.Physics.ARCADE),game.physics.arcade.enable(this.blockLayer),this.setEventHandlers(),this.initializePlayers(),this.createDimGraphic(),this.beginRoundAnimation("round_text/round_1.png")},createDimGraphic:function(){this.dimGraphic=game.add.graphics(0,0),this.dimGraphic.alpha=.7,this.dimGraphic.beginFill(o,1),this.dimGraphic.drawRect(0,0,game.camera.width,game.camera.height),this.dimGraphic.endFill()},restartGame:function(){this.dimGraphic.destroy(),player.reset();for(var t in this.remotePlayers)this.remotePlayers[t].reset();this.deadGroup=[],this.lastFrameTime,this.tearDownMap(),this.initializeMap(),this.bombs.destroy(!0),this.destroyItems(),this.bombs=new Phaser.Group(game),game.world.setChildIndex(this.bombs,2),this.gameFrozen=!1,socket.emit("ready for round")},destroyItems:function(){for(var t in this.items)this.items[t].destroy();this.items={}},onNewRound:function(t){this.createDimGraphic();var e=new m(game,t.completedRoundNumber,t.roundWinnerColors);this.gameFrozen=!0;var i;i=t.completedRoundNumber<2?"round_text/round_"+(t.completedRoundNumber+1)+".png":2==t.completedRoundNumber?"round_text/final_round.png":"round_text/tiebreaker.png",e.beginAnimation(this.beginRoundAnimation.bind(this,i,this.restartGame.bind(this)))},onEndGame:function(t){this.createDimGraphic(),this.gameFrozen=!0;var e=new m(game,t.completedRoundNumber,t.roundWinnerColors);e.beginAnimation(function(){game.state.start("GameOver",!0,!1,t.gameWinnerColor,!1)})},onNoOpponentsLeft:function(t){game.state.start("GameOver",!0,!1,null,!0)},beginRoundAnimation:function(t,e){var i=game.add.image(-600,game.camera.height/2,TEXTURES,t);i.anchor.setTo(.5,.5);var o=game.add.tween(i);o.to({x:game.camera.width/2},300).to({x:1e3},300,Phaser.Easing.Default,!1,800).onComplete.add(function(){this.dimGraphic.destroy(),i.destroy(),this.gameFrozen=!1,e&&e()},this),o.start()},update:function(){if(null!=player&&1==player.alive)if(this.gameFrozen)player.freeze();else{player.handleInput();for(var t in this.items){var e=this.items[t];game.physics.arcade.overlap(player,e,function(t,i){socket.emit("powerup overlap",{x:e.x,y:e.y})})}}this.stopAnimationForMotionlessPlayers(),this.storePreviousPositions();for(var i in this.remotePlayers)this.remotePlayers[i].interpolate(this.lastFrameTime);this.lastFrameTime=game.time.now,this.destroyDeadSprites()},destroyDeadSprites:function(){level.deadGroup.forEach(function(t){t.destroy()})},render:function(){1==window.debugging&&game.debug.body(player)},storePreviousPositions:function(){for(var t in this.remotePlayers)remotePlayer=this.remotePlayers[t],remotePlayer.previousPosition={x:remotePlayer.position.x,y:remotePlayer.position.y}},stopAnimationForMotionlessPlayers:function(){for(var t in this.remotePlayers)remotePlayer=this.remotePlayers[t],remotePlayer.lastMoveTime<game.time.now-200&&remotePlayer.animations.stop()},onSocketDisconnect:function(){console.log("Disconnected from socket server."),this.broadcast.emit("remove player",{id:this.id})},initializePlayers:function(){for(var t in this.players){var e=this.players[t];e.id==this.playerId?player=new h(e.x,e.y,e.id,e.color):this.remotePlayers[e.id]=new l(e.x,e.y,e.id,e.color)}},tearDownMap:function(){this.map.destroy(),this.groundLayer.destroy(),this.blockLayer.destroy()},initializeMap:function(){this.map=game.add.tilemap(this.tilemapName);var t=n[this.tilemapName];this.map.addTilesetImage(t.tilesetName,t.tilesetImage,40,40),this.groundLayer=new Phaser.TilemapLayer(game,this.map,this.map.getLayerIndex(t.groundLayer),game.width,game.height),game.world.addAt(this.groundLayer,0),this.groundLayer.resizeWorld(),this.blockLayer=new Phaser.TilemapLayer(game,this.map,this.map.getLayerIndex(t.blockLayer),game.width,game.height),game.world.addAt(this.blockLayer,1),this.blockLayer.resizeWorld(),this.map.setCollision(t.collisionTiles,!0,t.blockLayer);var e=game.cache.getTilemapData(this.tilemapName).data.layers[1];socket.emit("register map",{tiles:e.data,height:e.height,width:e.width,destructibleTileId:t.destructibleTileId})},onMovePlayer:function(t){if(!(player&&t.id==player.id||this.gameFrozen)){var e=this.remotePlayers[t.id];if(e.targetPosition){if(e.animations.play(t.f),e.lastMoveTime=game.time.now,t.x==e.targetPosition.x&&t.y==e.targetPosition.y)return;e.position.x=e.targetPosition.x,e.position.y=e.targetPosition.y,e.distanceToCover={x:t.x-e.targetPosition.x,y:t.y-e.targetPosition.y},e.distanceCovered={x:0,y:0}}e.targetPosition={x:t.x,y:t.y}}},onRemovePlayer:function(t){var e=this.remotePlayers[t.id];e.alive&&e.destroy(),delete this.remotePlayers[t.id],delete this.players[t.id]},onKillPlayer:function(t){if(t.id==player.id)console.log("You've been killed."),player.kill();else{var e=this.remotePlayers[t.id];e.kill()}},onPlaceBomb:function(t){this.bombs.add(new u(t.x,t.y,t.id))},onDetonate:function(t){u.renderExplosion(t.explosions),level.bombs.forEach(function(e){e&&e.id==t.id&&e.remove()},level),t.destroyedTiles.forEach(function(t){this.map.removeTile(t.col,t.row,1),t.itemId&&this.generateItemEntity(t.itemId,t.row,t.col)},this)},onPowerupAcquired:function(t){this.items[t.powerupId].destroy(),delete this.items[t.powerupId],t.acquiringPlayerId===player.id&&(r.playPowerupSound(),c.showPowerupNotification(t.powerupType,player.x,player.y),t.powerupType==s.SPEED&&player.applySpeedPowerup())},generateItemEntity:function(t,e,i){var o=d[t],s=new Phaser.Sprite(game,i*a,e*a,TEXTURES,o);game.physics.enable(s,Phaser.Physics.ARCADE),this.items[e+"."+i]=s,game.world.addAt(s,2)}}},{"../../../../common/map_info":21,"../../../../common/powerup_ids":22,"../entities/bomb":2,"../entities/player":3,"../entities/remoteplayer":4,"../entities/round_end_animation":5,"../util/audio_player":15,"../util/powerup_image_keys":17,"../util/powerup_notification_player":18}],10:[function(t,e,i){var o=function(){},a=t("../util/text_configurer"),s=130,n=OTX+40,r=60,h=260,l=25,u=70;e.exports=o,o.prototype={init:function(t){},create:function(){this.stateSettings={empty:{outFrame:"lobby/slots/game_slot_01.png",overFrame:"lobby/slots/game_slot_02.png",text:"HOST GAME ",callback:this.hostGameAction},joinable:{outFrame:"lobby/slots/game_slot_03.png",overFrame:"lobby/slots/game_slot_04.png",text:"JOIN GAME ",callback:this.joinGameAction},settingup:{outFrame:"lobby/slots/game_slot_05.png",overFrame:"lobby/slots/game_slot_05.png",text:"GAME IS BEING SET UP... ",callback:null},inprogress:{outFrame:"lobby/slots/game_slot_05.png",overFrame:"lobby/slots/game_slot_05.png",text:"GAME IN PROGRESS ",callback:null},full:{outFrame:"lobby/slots/game_slot_05.png",overFrame:"lobby/slots/game_slot_05.png",text:"GAME FULL ",callback:null}},this.backdrop=game.add.image(OTX+12.5,12.5,TEXTURES,"lobby/lobby_backdrop.png"),this.header=game.add.text(game.camera.width/2,u,"LOBBY"),this.header.anchor.setTo(.5,.5),a.configureText(this.header,"white",32),this.slots=[],this.labels=[];socket.emit("enter lobby"),socket.hasListeners("add slots")||(socket.on("add slots",this.addSlots.bind(this)),socket.on("update slot",this.updateSlot.bind(this)))},update:function(){},addSlots:function(t){if(!(this.slots.length>0))for(var e=0;e<t.length;e++){var i=null,o=t[e].state,u=this.stateSettings[o];!function(t,e){null!=e&&(i=function(){e(t)})}(e,u.callback);var m=s+e*r;this.slots[e]=game.add.button(n,m,TEXTURES,i,null,u.overFrame,u.outFrame),this.slots[e].setDownSound(buttonClickSound);var d=game.add.text(n+h,m+l,u.text);a.configureText(d,"white",18),d.anchor.setTo(.5,.5),this.labels[e]=d}},hostGameAction:function(t){socket.emit("host game",{gameId:t}),socket.removeAllListeners(),game.state.start("StageSelect",!0,!1,t)},joinGameAction:function(t){socket.removeAllListeners(),game.state.start("PendingGame",!0,!1,null,t)},updateSlot:function(t){var e=this.stateSettings[t.newState],i=t.gameId,o=this.slots[i];this.labels[i].setText(e.text),o.setFrames(e.overFrame,e.outFrame),o.onInputUp.removeAll(),o.onInputUp.add(function(){return e.callback(i)},this)}}},{"../util/text_configurer":19}],11:[function(t,e,i){var o=t("../util/text_configurer"),a=function(){};e.exports=a;var s=OTX+40,n=50,r=OTX+330,h=400,l=450,u=OTX+330,m=80,d=105,c=100,p=4.5,g=4.5,b=OTX+80,y=400,f=6;a.prototype={init:function(t,e,i){this.tilemapName=t,this.gameId=e},create:function(){socket.emit("enter pending game",{gameId:this.gameId});game.add.image(s,n,TEXTURES,"lobby/backdrop.png");this.startGameButton=game.add.button(r,h,TEXTURES,null,this,"lobby/buttons/start_game_button_03.png","lobby/buttons/start_game_button_03.png"),this.leaveGameButton=game.add.button(r,l,TEXTURES,this.leaveGameAction,null,"lobby/buttons/leave_game_button_02.png","lobby/buttons/leave_game_button_01.png"),this.leaveGameButton.setDownSound(buttonClickSound),this.characterSquares=this.drawCharacterSquares(4),this.characterImages=[],this.numPlayersInGame=0,this.minPlayerMessage=game.add.text(b,y,"Cannot start game without\nat least 2 players."),o.configureText(this.minPlayerMessage,"red",17),this.minPlayerMessage.visible=!1,socket.on("show current players",this.populateCharacterSquares.bind(this)),socket.on("player joined",this.playerJoined.bind(this)),socket.on("player left",this.playerLeft.bind(this)),socket.on("start game on client",this.startGame)},update:function(){},drawCharacterSquares:function(t){for(var e=[],i=m,o=u,a=0;f>a;a++){var s=t>a?"lobby/slots/character_square_01.png":"lobby/slots/character_square_02.png";e[a]=game.add.sprite(o,i,TEXTURES,s),a%2==0?o+=d:(o=u,i+=c)}return e},populateCharacterSquares:function(t){this.numPlayersInGame=0;for(var e in t.players){var i=t.players[e].color;this.characterImages[e]=game.add.image(this.characterSquares[this.numPlayersInGame].position.x+p,this.characterSquares[this.numPlayersInGame].position.y+g,TEXTURES,"lobby/bomberman_head/bomberman_head_"+i+".png"),this.numPlayersInGame++}this.numPlayersInGame>1?this.activateStartGameButton():this.minPlayerMessage.visible=!0},playerJoined:function(t){this.numPlayersInGame++;var e=this.numPlayersInGame-1;this.characterImages[t.id]=game.add.image(this.characterSquares[e].position.x+p,this.characterSquares[e].position.y+g,TEXTURES,"lobby/bomberman_head/bomberman_head_"+t.color+".png"),2==this.numPlayersInGame&&this.activateStartGameButton()},activateStartGameButton:function(){this.minPlayerMessage.visible=!1,this.startGameButton.setFrames("lobby/buttons/start_game_button_02.png","lobby/buttons/start_game_button_01.png"),this.startGameButton.onInputUp.removeAll(),this.startGameButton.onInputUp.add(this.startGameAction,this),this.startGameButton.setDownSound(buttonClickSound)},deactivateStartGameButton:function(){this.minPlayerMessage.visible=!0,this.startGameButton.setFrames("lobby/buttons/start_game_button_03.png","lobby/buttons/start_game_button_03.png"),this.startGameButton.onInputUp.removeAll(),this.startGameButton.setDownSound(null)},playerLeft:function(t){this.numPlayersInGame--,1==this.numPlayersInGame&&this.deactivateStartGameButton();for(var e in this.characterImages)this.characterImages[e].destroy();this.populateCharacterSquares(t)},startGameAction:function(){socket.emit("start game on server")},leaveGameAction:function(){socket.emit("leave pending game"),socket.removeAllListeners(),game.state.start("Lobby",!0,!1)},startGame:function(t){socket.removeAllListeners(),game.state.start("Level",!0,!1,t.mapName,t.players,this.id)}}},{"../util/text_configurer":19}],12:[function(t,e,i){function o(){}var a=t("../util/text_configurer"),s=function(){};e.exports=s,s.prototype={displayLoader:function(){o(),this.text=game.add.text(game.camera.width/2,250,"LOADING... "),this.text.anchor.setTo(.5,.5),a.configureText(this.text,"white",32),this.load.onFileComplete.add(function(t){this.text.setText("LOADING... "+t+"%")},this),this.load.onLoadComplete.add(function(){game.state.start("TitleScreen")})},preload:function(){this.displayLoader(),this.load.atlasJSONHash("bbo_textures","assets/textures/bbo_textures.png","assets/textures/bbo_textures.json"),this.load.atlasJSONHash("map_thumbnails","assets/maps/map_thumbnails.png","assets/maps/map_thumbnails.json"),this.load.tilemap("map_01","assets/maps/map_01.json",null,Phaser.Tilemap.TILED_JSON),this.load.tilemap("map_02","assets/maps/map_02.json",null,Phaser.Tilemap.TILED_JSON),this.load.image("tiles","assets/tiles/tileset.png"),this.load.image("repeating_bombs","assets/repeating_bombs.png"),this.load.audio("explosion","assets/sounds/bomb.ogg"),this.load.audio("powerup","assets/sounds/powerup.ogg"),this.load.audio("click","assets/sounds/click.ogg"),this.load.atlasJSONHash("compass","assets/textures/bbo_textures.png","assets/textures/bbo_textures.json"),this.load.atlasJSONHash("touch_segment","assets/textures/bbo_textures.png","assets/textures/bbo_textures.json"),this.load.atlasJSONHash("touch","assets/textures/bbo_textures.png","assets/textures/bbo_textures.json"),window.buttonClickSound=new Phaser.Sound(game,"click",.25)}}},{"../util/text_configurer":19}],13:[function(t,e,i){var o=function(){};e.exports=o;var a=OTX+40,s=50,n=OTX+215,r=150,h=328,l=[{name:"Map 1",thumbnailKey:"map_01.png",tilemapName:"map_01",maxPlayers:4,size:"medium"},{name:"Map 2",thumbnailKey:"map_02.png",tilemapName:"map_02",maxPlayers:4,size:"medium"}];o.prototype={init:function(t,e){this.gameId=t},create:function(){game.add.image(a,s,TEXTURES,"lobby/select_stage.png");this.selectedStageIndex=0;var t=l[this.selectedStageIndex];this.leftButton=game.add.button(OTX+100,180,TEXTURES,this.leftSelect,this,"lobby/buttons/left_select_button_02.png","lobby/buttons/left_select_button_01.png"),this.rightButton=game.add.button(OTX+450,180,TEXTURES,this.rightSelect,this,"lobby/buttons/right_select_button_02.png","lobby/buttons/right_select_button_01.png"),this.okButton=game.add.button(OTX+495,460,TEXTURES,this.confirmStageSelection,this,"lobby/buttons/ok_button_02.png","lobby/buttons/ok_button_01.png"),this.backLobbyButton=game.add.button(OTX+43,460,TEXTURES,this.backLobby,this,"gamesprites/bomb/cancel.png","gamesprites/bomb/cancel.png"),this.leftButton.setDownSound(buttonClickSound),this.rightButton.setDownSound(buttonClickSound),this.okButton.setDownSound(buttonClickSound),this.thumbnail=game.add.image(n,r,MAP_THUMBNAILS,t.thumbnailKey),this.text=game.add.text(game.camera.width/2,h,t.name),this.configureText(this.text,"white",28),this.text.anchor.setTo(.5,.5),this.numPlayersText=game.add.text(OTX+145,390,"Max # of players:   "+t.maxPlayers),this.configureText(this.numPlayersText,"white",18),this.stageSizeText=game.add.text(OTX+145,420,"Map size:   "+t.size),this.configureText(this.stageSizeText,"white",18)},leftSelect:function(){0===this.selectedStageIndex?this.selectedStageIndex=l.length-1:this.selectedStageIndex--,this.updateStageInfo()},rightSelect:function(){this.selectedStageIndex===l.length-1?this.selectedStageIndex=0:this.selectedStageIndex++,this.updateStageInfo()},update:function(){},updateStageInfo:function(){var t=l[this.selectedStageIndex];this.text.setText(t.name),this.numPlayersText.setText("Max # of players:   "+t.maxPlayers),this.stageSizeText.setText("Map size:   "+t.size),this.thumbnail.loadTexture(MAP_THUMBNAILS,t.thumbnailKey)},configureText:function(t,e,i){t.font="Oswald",t.fill=e,t.fontSize=i},confirmStageSelection:function(){var t=l[this.selectedStageIndex];socket.emit("select stage",{mapName:t.tilemapName}),game.state.start("PendingGame",!0,!1,t.tilemapName,this.gameId)},backLobby:function(){game.state.start("Lobby")}}},{}],14:[function(t,e,i){function o(){}var a=t("../util/fader"),s=OTX-10,n=60,r=OTX+23,h=293,l=363,u=OTX+315,m=225,d=1080,c=8e4,p=[];o.prototype={create:function(){this.showingInstructions=!1,this.justClickedHowTo=!1,this.justClickedOutOfHowTo=!1,this.createClouds(),this.createButtons();var t=this.createInitialButtonTween(this.startButton,200),e=this.createInitialButtonTween(this.howToButton,400),i=game.add.image(s,n-220,TEXTURES,"titlescreen/newtitle.png"),o=game.add.tween(i);o.to({y:n},500,Phaser.Easing.Bounce.Out,!0,200).start();var a=game.add.sprite(u+400,m,TEXTURES,"titlescreen/bomberman/bomberman_01.png");a.animations.add("bomb_animation",["titlescreen/bomberman/bomberman_01.png","titlescreen/bomberman/bomberman_02.png","titlescreen/bomberman/bomberman_03.png","titlescreen/bomberman/bomberman_04.png","titlescreen/bomberman/bomberman_05.png"],5,!0);var r=game.add.tween(a).to({x:u},300,Phaser.Easing.Default,!1,100);r.onComplete.addOnce(function(){a.animations.play("bomb_animation")}),r.start(),t.start(),e.start()},createInitialButtonTween:function(t,e){return game.add.tween(t).to({x:r},300,Phaser.Easing.Default,!1,e)},createClouds:function(){var t=(game.camera.width,-260),e=c*(game.camera.width-t)/game.camera.width;game.add.image(0,0,TEXTURES,"titlescreen/background2.png");
for(var i=0;i<p.length;i++)!function(i){var o=game.add.image(i.startingX,i.startingY,TEXTURES,"titlescreen/"+i.image+".png");o.anchor.setTo(0,0);var a=c*(game.camera.width-i.startingX)/game.camera.width,s=game.add.tween(o).to({x:d},a,Phaser.Easing.Default,!0,0,0),n=function(){o.x=t,game.add.tween(o).to({x:d},e,Phaser.Easing.Default,!0,0,-1).start()};s.onComplete.addOnce(n),s.start()}(p[i])},createButtons:function(){this.startButton=game.add.button(r-490,h,TEXTURES,function(){this.showingInstructions||this.justClickedOutOfHowTo||a.fadeOut(function(){game.state.start("Lobby")})},this,"titlescreen/buttons/startbutton_02.png","titlescreen/buttons/startbutton_01.png"),this.startButton.setDownSound(buttonClickSound),this.howToButton=game.add.button(r-490,l,TEXTURES,function(){this.showingInstructions||this.justClickedOutOfHowTo||(this.showingInstructions=!0,a.fadeOut(function(){this.howTo=game.add.image(OTX+0,0,TEXTURES,"titlescreen/howtoplay.png"),this.justClickedHowTo=!0,a.fadeIn()},this))},this,"titlescreen/buttons/howtobutton_02.png","titlescreen/buttons/howtobutton_01.png"),this.howToButton.setDownSound(buttonClickSound)},update:function(){!game.input.activePointer.isDown&&this.justClickedHowTo&&(this.justClickedHowTo=!1),!game.input.activePointer.isDown&&this.justClickedOutOfHowTo&&(this.justClickedOutOfHowTo=!1),game.input.activePointer.isDown&&this.showingInstructions&&!this.justClickedHowTo&&(buttonClickSound.play(),this.showingInstructions=!1,this.justClickedOutOfHowTo=!0,a.fadeOut(function(){this.howTo.destroy(),a.fadeIn()},this))}},e.exports=o},{"../util/fader":16}],15:[function(t,e,i){var o,a;e.exports={initialize:function(){o=game.add.audio("explosion"),a=game.add.audio("powerup")},playBombSound:function(){o.play()},playPowerupSound:function(){a.play()}}},{}],16:[function(t,e,i){var o="#000000";e.exports={createFadeTween:function(t,e,i){i=i||300,this.fadeGraphic&&this.fadeGraphic.destroy(),this.fadeGraphic=game.add.graphics(0,0),this.fadeGraphic.beginFill(o,1),this.fadeGraphic.drawRect(0,0,game.camera.width,game.camera.height),this.fadeGraphic.fixedToCamera=!0,this.fadeGraphic.alpha=t,this.fadeGraphic.endFill();var a=game.add.tween(this.fadeGraphic);return a.to({alpha:e},i,Phaser.Easing.Default),a},createFadeInTween:function(t){return this.createFadeTween(1,0,t)},createFadeOutTween:function(t){return this.createFadeTween(0,1,t)},fadeOut:function(t,e,i){e=e?e:this;var o=this.createFadeOutTween(i);"function"==typeof t&&o.onComplete.add(t,e),o.start()},fadeIn:function(t,e,i){e=e?e:this;var o=this.createFadeInTween(i);"function"==typeof t&&o.onComplete.add(t,this),o.start()}}},{}],17:[function(t,e,i){var o=t("../../../../common/powerup_ids"),a={};a[o.BOMB_STRENGTH]="gamesprites/bomb_strength_powerup.png",a[o.BOMB_CAPACITY]="gamesprites/bomb_count_powerup.png",a[o.SPEED]="gamesprites/speed_powerup.png",e.exports=a},{"../../../../common/powerup_ids":22}],18:[function(t,e,i){var o=t("../../../../common/powerup_ids"),a={};a[o.BOMB_STRENGTH]="gamesprites/bomb_strength_notification.png",a[o.BOMB_CAPACITY]="gamesprites/bomb_count_notification.png",a[o.SPEED]="gamesprites/speed_notification.png",i.showPowerupNotification=function(t,e,i){var o=a[t],s=new Phaser.Image(game,e,i-10,TEXTURES,o);s.anchor.setTo(.5,.5),game.add.existing(s);var n=game.add.tween(s);n.to({y:s.y-30},600,Phaser.Easing.Default,!0,0);var r=game.add.tween(s);r.to({alpha:0},600,Phaser.Easing.Default,!0,0),n.onComplete.addOnce(function(t){t.destroy()})}},{"../../../../common/powerup_ids":22}],19:[function(t,e,i){i.configureText=function(t,e,i){t.font="Oswald",t.fill=e,t.fontSize=i}},{}],20:[function(t,e,i){e.exports={getFrames:function(t,e,i){var o=[];return i.forEach(function(i){o.push(t(e,i))}),o}}},{}],21:[function(t,e,i){var o={map_01:{spawnLocations:[{x:8,y:1},{x:19,y:1},{x:19,y:13},{x:8,y:13}],collisionTiles:[169,191],groundLayer:"Ground",blockLayer:"Blocks",tilesetName:"tiles",tilesetImage:"tiles",destructibleTileId:191},map_02:{spawnLocations:[{x:8,y:1},{x:19,y:1},{x:19,y:13},{x:8,y:13}],collisionTiles:[127,367],groundLayer:"Ground",blockLayer:"Blocks",tilesetName:"tiles",tilesetImage:"tiles",destructibleTileId:367}};e.exports=o},{}],22:[function(t,e,i){e.exports={BOMB_STRENGTH:5,BOMB_CAPACITY:6,SPEED:7,isAPowerup:function(t){return t===this.BOMB_STRENGTH||t===this.BOMB_CAPACITY||t===this.SPEED}}},{}]},{},[1]);